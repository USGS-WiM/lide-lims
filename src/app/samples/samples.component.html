<div class="row">
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <h3>Samples</h3>
    </div>
</div>

<!--Add sample card -->
<div class="row">
    <div class="col-lg-8 col-md-12 col-sm-12 col-xs-12" *ngIf="showHideAdd">
        <!-- begin card-->
        <div class="card">
            <div class="card-block">
                <div class="card-title">Add Sample
                    <clr-signpost>
                        <clr-icon shape="info-standard" clrSignpostTrigger></clr-icon>
                        <clr-signpost-content *clrIfOpen>
                            <p>Select a matrix to activate inputs and begin. Invalid inputs for the selected matrix will remain
                                disabled.
                            </p>
                        </clr-signpost-content>
                    </clr-signpost>
                </div>

                <div class="card-text">
                    <!-- begin form -->
                    <form class="form compact" [formGroup]="addSampleForm" (ngSubmit)="onSubmitSample('add', addSampleForm.value)">
                        <section class="form-block">

                            <!-- sample type select form, without Clarity UI validation -->
                            <!--<div class="form-group" >
                                <label for="sampleTypeSelect">Sample type</label>
                                <div class="select">
                                    <select id="sampleTypeSelect" name="sample_type" formControlName="sample_type">
                                        <option value="Default">Select Sample Type...</option>
                                        <option *ngFor="let type of sampleTypes" [value]="type.sample_type_id">{{type.sample_type}}</option>
                                    </select>
                                </div>
                            </div>-->

                            <div class="form-group">
                                <label class="required">Matrix</label>
                                <label for="matrixSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('matrix_type').invalid && (addSampleForm.get('matrix_type').dirty || addSampleForm.get('matrix_type').touched)">
                                    <div class="select">
                                        <select id="matrixSelect" name="matrix_type" formControlName="matrix_type" (change)="onMatrixSelect($event.target.value)">
                                            <option *ngFor="let matrix of matrices" [value]="matrix.id">{{matrix.name}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="required">Study</label>
                                <label for="studySelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('study').invalid && (addSampleForm.get('study').dirty || addSampleForm.get('study').touched)">
                                    <div class="select">
                                        <select id="studySelect" name="study" formControlName="study">
                                            <option value="">
                                                <span class="all">NO STUDY ASSOCIATION</span>
                                            </option>
                                            <option *ngFor="let study of studies" [value]="study.id">{{study.name}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="required">Sample type</label>
                                <label for="sampleTypeSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('sample_type').invalid && (addSampleForm.get('sample_type').dirty || addSampleForm.get('sample_type').touched)">
                                    <div class="select">
                                        <select id="sampleTypeSelect" name="sample_type" formControlName="sample_type">
                                            <option *ngFor="let sampleType of sampleTypes" [value]="sampleType.id">{{sampleType.name}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>

                            <div class="form-group">
                                <label class="required">Collaborator Sample ID</label>
                                <label for="collabSampleIdInput" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('collaborator_sample_id').invalid && (addSampleForm.get('collaborator_sample_id').dirty || addSampleForm.get('collaborator_sample_id').touched)">
                                    <input id="collabSampleIdInput" type="text" formControlName="collaborator_sample_id">
                                    <span class="tooltip-content">Collaborator ID is required.</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label>Filtered</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="filteredToggle" formControlName="filter_flag">
                                    <label for="filteredToggle">{{this.addSampleForm.controls.filter_flag.value ? "Yes" : "No"}}</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Secondary Concentration</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="secondaryConcToggle" formControlName="secondary_concentration_flag">
                                    <label for="secondaryConcToggle">{{this.addSampleForm.controls.secondary_concentration_flag.value ? "Yes" : "No"}}</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="studySiteNameInput">Study Site Name</label>
                                <input id="studySiteNameInput" type="text" formControlName="study_site_name">
                            </div>


                            <div class="form-group">
                                <label for="sampleDescInput">Sample Description</label>
                                <textarea id="sampleDescInput" rows="2" formControlName="sample_description" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="sampleDescInput">Sample Notes</label>
                                <textarea id="sampleDescInput" rows="2" formControlName="sample_notes" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="collectStartDateInput">Arrival Date</label>
                                <input type="date" id="collectStartDateInput" formControlName="arrival_date">
                            </div>

                            <div class="form-group">
                                <label for="sampleDescInput">Arrival Notes</label>
                                <textarea id="sampleDescInput" rows="2" formControlName="arrival_notes" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label>Sampler Name</label>
                                <label for="samplerNameSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('sampler_name').invalid && (addSampleForm.get('sampler_name').dirty || addSampleForm.get('sampler_name').touched)">
                                    <div class="select">
                                        <select id="samplerNameSelect" name="samplerName" formControlName="sampler_name">
                                            <option *ngFor="let user of users" [value]="user.id">{{user.username}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>


                            <div class="form-group">
                                <label for="collectStartDateInput" class="required">Collection Start Date</label>
                                <input type="date" id="collectStartDateInput" formControlName="collection_start_date">
                            </div>

                            <!--begin variable display section-->

                            <div class="form-group">
                                <label for="collectStartTime">Collection Start Time (HH:MM)</label>
                                <label for="collectStartTime" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('collection_start_time').invalid && (addSampleForm.get('collection_start_time').dirty || addSampleForm.get('collection_start_time').touched)">
                                    <input id="collectStartTime" type="text" formControlName="collection_start_time">
                                    <span class="tooltip-content">Must follow format HH:MM</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="collectEndDateInput">Collection End Date</label>
                                <input type="date" id="collectEndDateInput" formControlName="collection_end_date">
                            </div>

                            <div class="form-group">
                                <label for="collectEndTime">Collection End Time (HH:MM)</label>
                                <label for="collectEndTime" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('collection_end_time').invalid && (addSampleForm.get('collection_end_time').dirty || addSampleForm.get('collection_end_time').touched)">
                                    <input id="collectEndTime" type="text" formControlName="collection_end_time">
                                    <span class="tooltip-content">Must follow format HH:MM</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="imrInput">Initial Meter Reading</label>
                                <input type="text" id="imrInput" formControlName="meter_reading_initial">
                                <div class="select">
                                    <select id="meter_reading_initialUnitSelect" formControlName="meter_reading_unit" (change)="onUnitChange($event.target.value)">
                                        <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="fmrInput">Final Meter Reading</label>
                                <input type="text" id="fmrInput" formControlName="meter_reading_final">
                                <label *ngIf="this.units">{{this.unitValue | displayValue:'name':this.units}}</label>
                            </div>

                            <div class="form-group">
                                <label for="tvsInput">Total Volume (or mass) Sampled</label>
                                <input type="text" id="tvsInput" formControlName="total_volume_sampled_initial">
                                <div class="select">
                                    <select id="tvsUnitSelect" formControlName="total_volume_sampled_unit_initial">
                                        <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="volPostDiluteInput">Volume After Dilution</label>
                                <input id="volPostDiluteInput" type="text" formControlName="post_dilution_volume">
                                <span>µL</span>
                            </div>

                            <div class="form-group">
                                <label class="required">Filter Type</label>
                                <label for="filterSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('filter_type').invalid && (addSampleForm.get('filter_type').dirty || addSampleForm.get('filter_type').touched)">
                                    <div class="select">
                                        <select id="filterSelect" name="filterType" formControlName="filter_type">
                                            <option *ngFor="let filterType of filterTypes" [value]="filterType.id">{{filterType.name}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="filterBornOnDateInput">Filter Born-on Date</label>
                                <input type="date" id="filterBornOnDateInput" formControlName="filter_born_on_date">
                            </div>

                            <div class="form-group">
                                <label for="dissVolInput">Dissolution Volume</label>
                                <input id="dissVolInput" type="text" formControlName="dissolution_volume">
                                <span>mL</span>
                            </div>

                            <div class="form-group">
                                <label for="eluteNotesInput">Elution Notes</label>
                                <textarea id="eluteNotesInput" rows="2" formControlName="elution_notes" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="techInitInput">Tech Intials</label>
                                <input id="techInitInput" type="text" formControlName="technician_initials">
                            </div>

                            <div class="form-group">
                                <label for="eluteVolInput">Eluent/Backflush Volume Used</label>
                                <input id="eluteVolInput" type="text" formControlName="sample_volume_initial">
                            </div>

                            <div class="form-group">
                                <label>Peg Neg</label>
                                <label for="pegNegSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addSampleForm.get('matrix_type').invalid && (addSampleForm.get('matrix_type').dirty || addSampleForm.get('matrix_type').touched)">
                                    <div class="select">
                                        <select id="pegNegSelect" name="peg_neg" formControlName="peg_neg">
                                            <option *ngFor="let pegneg of pegnegs" [value]="pegneg.id">ID:{{pegneg.id}} Date:{{pegneg.collection_start_date | date:'shortDate'}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>

                            <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showSampleCreateError">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Submission error. Sample not submitted.</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="onSubmitSample('add', addSampleForm.value)">Try again</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <clr-alert [clrAlertType]="'alert-success'" *ngIf="showSampleCreateSuccess">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Sample successfully submitted</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="showHideAdd = false; showSampleCreateSuccess = false">Close</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <button class="btn btn-primary" type="submit" [disabled]="addSampleForm.invalid" [clrLoading]="submitLoading">Submit</button>
                            <button class="btn btn-info" (click)="showHideAdd = !showHideAdd">Cancel</button>
                        </section>
                        <!--<p>Form value: {{ addSampleForm.value | json }}</p>
                        <p>Form status: {{ addSampleForm.status | json }}</p> -->
                    </form>
                    <!-- end form -->
                </div>
            </div>
            <!-- end card -->
        </div>
    </div>
</div>

<!--Add peg neg card -->
<div class="row">
    <div class="col-lg-8 col-md-12 col-sm-12 col-xs-12" *ngIf="showHideAddPegNeg">
        <!-- begin card-->
        <div class="card">
            <div class="card-block">
                <div class="card-title">Add Peg Neg
                    <clr-signpost>
                        <clr-icon shape="info-standard" clrSignpostTrigger></clr-icon>
                        <clr-signpost-content *clrIfOpen>
                            <p>Create a peg neg control record. Associate with a sample in the Add Sample form.
                            </p>
                        </clr-signpost-content>
                    </clr-signpost>
                </div>

                <div class="card-text">
                    <!-- begin form -->
                    <form class="form compact" [formGroup]="addPegNegForm" (ngSubmit)="onSubmitSample('addPegNeg', addPegNegForm.value)">
                        <section class="form-block">


                            <div class="form-group">
                                <label>Filtered</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="filteredToggle" formControlName="filter_flag">
                                    <label for="filteredToggle">{{this.addSampleForm.controls.filter_flag.value ? "Yes" : "No"}}</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Secondary Concentration</label>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="secondaryConcToggle" formControlName="secondary_concentration_flag">
                                    <label for="secondaryConcToggle">{{this.addSampleForm.controls.secondary_concentration_flag.value ? "Yes" : "No"}}</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="pegnegDescInput">Description</label>
                                <textarea id="pegnegDescInput" rows="2" formControlName="sample_description" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="pegnegNotesInput">Notes</label>
                                <textarea id="pegnegNotesInput" rows="2" formControlName="sample_notes" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label class="required">Sampler Name</label>
                                <label for="samplerNameSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addPegNegForm.get('sampler_name').invalid && (addPegNegForm.get('sampler_name').dirty || addPegNegForm.get('sampler_name').touched)">
                                    <div class="select">
                                        <select id="samplerNameSelect" name="samplerName" formControlName="sampler_name">
                                            <option *ngFor="let user of users" [value]="user.id">{{user.username}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div>



                            <div class="form-group">
                                <label for="collectStartDateInput" class="required">Collection Start Date</label>
                                <input type="date" id="collectStartDateInput" formControlName="collection_start_date">
                            </div>

                            <!-- <div class="form-group">
                                <label for="collectStartTime">Collection Start Time (HH:MM)</label>
                                <label for="collectStartTime" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addPegNegForm.get('collection_start_time').invalid && (addPegNegForm.get('collection_start_time').dirty || addPegNegForm.get('collection_start_time').touched)">
                                    <input id="collectStartTime" type="text" formControlName="collection_start_time">
                                    <span class="tooltip-content">Must follow format HH:MM</span>
                                </label>
                            </div>

                            <div class="form-group">
                                <label for="collectEndDateInput">Collection End Date</label>
                                <input type="date" id="collectEndDateInput" formControlName="collection_end_date">
                            </div>

                            <div class="form-group">
                                <label for="collectEndTime">Collection End Time (HH:MM)</label>
                                <label for="collectEndTime" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addPegNegForm.get('collection_end_time').invalid && (addPegNegForm.get('collection_end_time').dirty || addPegNegForm.get('collection_end_time').touched)">
                                    <input id="collectEndTime" type="text" formControlName="collection_end_time">
                                    <span class="tooltip-content">Must follow format HH:MM</span>
                                </label>
                            </div> -->

                            <div class="form-group">
                                <label for="imrInput" class="required">Initial Meter Reading</label>
                                <input type="text" id="imrInput" formControlName="meter_reading_initial">
                                <div class="select">
                                    <select id="meter_reading_initialUnitSelect" formControlName="meter_reading_unit" (change)="onUnitChange($event.target.value)">
                                        <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="fmrInput" class="required">Final Meter Reading</label>
                                <input type="text" id="fmrInput" formControlName="meter_reading_final">
                                <label *ngIf="this.units">{{this.unitValue | displayValue:'name':this.units}}</label>
                            </div>

                            <div class="form-group">
                                <label for="tvsInput" class="required">Total Volume (or mass) Sampled</label>
                                <input type="text" id="tvsInput" formControlName="total_volume_sampled_initial">
                                <div class="select">
                                    <select id="tvsUnitSelect" formControlName="total_volume_sampled_unit_initial">
                                        <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <!-- <div class="form-group">
                                <label for="volPostDiluteInput">Volume After Dilution</label>
                                <input id="volPostDiluteInput" type="text" formControlName="post_dilution_volume">
                                <span>µL</span>
                            </div> -->

                            <!-- <div class="form-group">
                                <label class="required">Filter Type</label>
                                <label for="filterSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="addPegNegForm.get('filter_type').invalid && (addPegNegForm.get('filter_type').dirty || addPegNegForm.get('filter_type').touched)">
                                    <div class="select">
                                        <select id="filterSelect" name="filterType" formControlName="filter_type">
                                            <option *ngFor="let filterType of filterTypes" [value]="filterType.id">{{filterType.name}}</option>
                                        </select>
                                    </div>
                                </label>
                            </div> -->

                            <div class="form-group">
                                <label for="filterBornOnDateInput" class="required">Filter Born-on Date</label>
                                <input type="date" id="filterBornOnDateInput" formControlName="filter_born_on_date">
                            </div>

                            <div class="form-group">
                                <label for="dissVolInput" class="required">Dissolution Volume</label>
                                <input id="dissVolInput" type="text" formControlName="dissolution_volume">
                                <span>mL</span>
                            </div>

                            <div class="form-group">
                                <label for="eluteNotesInput">Elution Notes</label>
                                <textarea id="eluteNotesInput" rows="2" formControlName="elution_notes" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="techInitInput">Tech Intials</label>
                                <input id="techInitInput" type="text" formControlName="technician_initials">
                            </div>

                            <div class="form-group">
                                <label for="eluteVolInput">Eluent/Backflush Volume Used</label>
                                <input id="eluteVolInput" type="text" formControlName="sample_volume_initial">
                            </div>

                            <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showSampleCreateError">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Submission error. Sample not submitted.</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="onSubmitSample('add', addPegNegForm.value)">Try again</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <clr-alert [clrAlertType]="'alert-success'" *ngIf="showSampleCreateSuccess">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Sample successfully submitted</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="showHideAdd = false; showSampleCreateSuccess = false">Close</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <button class="btn btn-primary" type="submit" [disabled]="addPegNegForm.invalid" [clrLoading]="submitLoading">Submit</button>
                            <button class="btn btn-info" (click)="showHideAddPegNeg = !showHideAddPegNeg">Cancel</button>
                        </section>
                        <!-- <p>Form value: {{ addPegNegForm.value | json }}</p> -->
                        <!-- <p>Form status: {{ addPegNegForm.status | json }}</p> -->
                    </form>
                    <!-- end form -->

                </div>
            </div>
            <!-- end card -->
        </div>
    </div>
</div>

<!-- edit sample modal -->
<clr-modal [(clrModalOpen)]="showHideEdit">
    <h3 class="modal-title">Edit Sample</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-lg-12">
                <form id="editSampleForm" class="compact" [formGroup]="editSampleForm" (ngSubmit)="onSubmitSample('edit', editSampleForm.value)">
                    <section class="form-block">

                        <div class="form-group">
                            <label for="studyId">Sample ID</label>
                            <input type="text" id="studyId" size="35" formControlName="id" readonly>
                        </div>

                        <div class="form-group">
                            <label class="required">Matrix</label>
                            <label for="matrixSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('matrix_type').invalid && (editSampleForm.get('matrix_type').dirty || editSampleForm.get('matrix_type').touched)">
                                <div class="select">
                                    <select id="matrixSelect" name="matrix" formControlName="matrix_type" (change)="onMatrixSelect($event.target.value)">
                                        <option *ngFor="let matrix of matrices" [value]="matrix.id">{{matrix.name}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="required">Study</label>
                            <label for="studySelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('study').invalid && (editSampleForm.get('study').dirty || editSampleForm.get('study').touched)">
                                <div class="select">
                                    <select id="studySelect" name="study" formControlName="study">
                                        <option value="">
                                            <span class="all">NO STUDY ASSOCIATION</span>
                                        </option>
                                        <option *ngFor="let study of studies" [value]="study.id">{{study.name}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="required">Sample type</label>
                            <label for="sampleTypeSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('sample_type').invalid && (editSampleForm.get('sample_type').dirty || editSampleForm.get('sample_type').touched)">
                                <div class="select">
                                    <select id="sampleTypeSelect" name="sample_type" formControlName="sample_type">
                                        <option *ngFor="let sampleType of sampleTypes" [value]="sampleType.id">{{sampleType.name}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="required">Collaborator Sample ID</label>
                            <label for="collabSampleIdInput" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('collaborator_sample_id').invalid && (editSampleForm.get('collaborator_sample_id').dirty || editSampleForm.get('collaborator_sample_id').touched)">
                                <input id="collabSampleIdInput" type="text" formControlName="collaborator_sample_id">
                                <span class="tooltip-content">Collaborator ID is required.</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="required">Filtered</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="filteredToggle" formControlName="filter_flag">
                                <label for="filteredToggle">{{this.editSampleForm.controls.filter_flag.value ? "Yes" : "No"}}</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="required">Secondary Concentration</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="secondaryConcToggle" formControlName="secondary_concentration_flag">
                                <label for="secondaryConcToggle">{{this.editSampleForm.controls.secondary_concentration_flag.value ? "Yes" : "No"}}</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="studySiteNameInput">Study Site Name</label>
                            <input id="studySiteNameInput" type="text" formControlName="study_site_name">
                        </div>

                        <div class="form-group">
                            <label for="sampleDescInput">Sample Description</label>
                            <textarea id="sampleDescInput" rows="2" formControlName="sample_description" style="max-width:25em"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="sampleDescInput">Sample Notes</label>
                            <textarea id="sampleDescInput" rows="2" formControlName="sample_notes" style="max-width:25em"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="collectStartDateInput" class="required">Arrival Date</label>
                            <input type="date" id="collectStartDateInput" formControlName="arrival_date">
                        </div>

                        <div class="form-group">
                            <label for="sampleDescInput">Arrival Notes</label>
                            <textarea id="sampleDescInput" rows="2" formControlName="arrival_notes" style="max-width:25em"></textarea>
                        </div>

                        <div class="form-group">
                            <label>Sampler Name</label>
                            <label for="samplerNameSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('sampler_name').invalid && (editSampleForm.get('sampler_name').dirty || editSampleForm.get('sampler_name').touched)">
                                <div class="select">
                                    <select id="samplerNameSelect" name="samplerName" formControlName="sampler_name">
                                        <option *ngFor="let user of users" [value]="user.id">{{user.username}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="collectStartDateInput" class="required">Collection Start Date</label>
                            <input type="date" id="collectStartDateInput" formControlName="collection_start_date">
                        </div>

                        <!--begin variable display section-->

                        <div class="form-group">
                            <label for="collectStartTime">Collection Start Time (HH:MM)</label>
                            <input id="collectStartTime" type="text" formControlName="collection_start_time">
                        </div>

                        <div class="form-group">
                            <label for="collectEndDateInput">Collection End Date</label>
                            <input type="date" id="collectEndDateInput" formControlName="collection_end_date">
                        </div>

                        <div class="form-group">
                            <label for="collectEndTime">Collection End Time (HH:MM)</label>
                            <input id="collectEndTime" type="text" formControlName="collection_end_time">
                        </div>

                        <div class="form-group">
                            <label for="collectEndTime">FCSV</label>
                            <input id="collectEndTime" type="text" formControlName="final_concentrated_sample_volume">
                        </div>

                        <div class="form-group">
                            <label class="required">FCSV Type</label>
                            <label for="fcsvTypeSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('sample_type').invalid && (editSampleForm.get('sample_type').dirty || editSampleForm.get('sample_type').touched)">
                                <div class="select">
                                    <select id="fcsvTypeSelect" name="sample_type" formControlName="final_concentrated_sample_volume_type">
                                        <!-- <option *ngFor="let fcsvType of fcsvTypes" [value]="fscvType.id">{{fcsvType.name}}</option> -->
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="fcsvNotesInput">FCSV Notes</label>
                            <textarea id="fcsvNotesInput" rows="2" formControlName="final_concentrated_sample_volume_notes" style="max-width:25em"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="imrInput">Initial Meter Reading</label>
                            <input type="text" id="imrInput" formControlName="meter_reading_initial">
                            <div class="select">
                                <select id="imrSelect" formControlName="meter_reading_unit" (change)="onUnitChange($event.target.value)">
                                    <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="fmrInput">Final Meter Reading</label>
                            <input type="text" id="fmrInput" formControlName="meter_reading_final">
                            <label *ngIf="sampleSelected">
                                <span>{{this.unitValue | displayValue:'name':this.units }}</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="tvsInput">Total Volume (or mass) Sampled</label>
                            <input type="text" id="tvsInput" formControlName="total_volume_sampled_initial">
                            <div class="select">
                                <select id="tvsUnitSelect" formControlName="total_volume_sampled_unit_initial">
                                    <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="volPostDiluteInput">Volume After Dilution</label>
                            <input id="volPostDiluteInput" type="text" formControlName="post_dilution_volume">
                            <span>µL</span>
                        </div>

                        <div class="form-group">
                            <label class="required">Filter Type</label>
                            <label for="filterSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('filter_type').invalid && (editSampleForm.get('filter_type').dirty || editSampleForm.get('filter_type').touched)">
                                <div class="select">
                                    <select id="filterSelect" name="filterType" formControlName="filter_type">
                                        <option *ngFor="let filterType of filterTypes" [value]="filterType.id">{{filterType.name}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="filterBornOnDateInput">Collection Start Date</label>
                            <input type="date" id="filterBornOnDateInput" formControlName="filter_born_on_date">
                        </div>

                        <div class="form-group">
                            <label for="dissVolInput">Dissolution Volume</label>
                            <input id="dissVolInput" type="text" formControlName="dissolution_volume">
                            <span>mL</span>
                        </div>

                        <div class="form-group">
                            <label for="eluteNotesInput">Elution Notes</label>
                            <textarea id="eluteNotesInput" rows="2" formControlName="elution_notes" style="max-width:25em"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="techInitInput">Tech Intials</label>
                            <input id="techInitInput" type="text" formControlName="technician_initials">
                        </div>

                        <div class="form-group">
                            <label for="eluteVolInput">Eluent/Backflush Volume Used</label>
                            <input id="eluteVolInput" type="text" formControlName="sample_volume_initial">
                        </div>

                        <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showSampleEditError">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Submission error. Sample not updated.</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="onSubmitSample('add', editSampleForm.value)">Try again</a>
                                </div>
                            </div>
                        </clr-alert>

                        <clr-alert [clrAlertType]="'alert-success'" *ngIf="showSampleEditSuccess">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Sample successfully updated</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="showHideAdd = false; showSampleEditSuccess = false">Close</a>
                                </div>
                            </div>
                        </clr-alert>


                        <button class="btn btn-primary" type="submit" [disabled]="editSampleForm.invalid">Save Edits</button>
                        <button class="btn btn-info" (click)="showHideEdit = !showHideEdit">Cancel</button>
                    </section>
                    <!--<p>Form value: {{ editSampleForm.value | json }}</p>
                    <p>Form status: {{ editSampleForm.status | json }}</p> -->
                </form>
            </div>
            <!--<div class="col-lg-6">
                <form id="editPegnegForm" class="compact" [formGroup]="editSampleForm" (ngSubmit)="onSubmit()" [hidden]="submitted" >
                    <section class="form-block">
                        <label>Peg Neg Control</label>
                    </section>
                </form>
            </div>-->

        </div>
    </div>
    <!--<div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHideEdit = !showHideEdit">Cancel</button>
        <button type="submit" class="btn btn-primary"  [disabled]="editSampleForm.invalid">Save Edits</button>
    </div>-->
</clr-modal>
<!-- end edit sample modal -->

<!-- begin analysis batch modal -->
<clr-modal [(clrModalOpen)]="showHideABModal">
    <h3 class="modal-title">Create Analysis Batch</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-lg-12">

                <form id="createABForm" class="compact" [formGroup]="createABForm" (ngSubmit)="onSubmitAB(createABForm.value)">
                    <section class="form-block">

                        <clr-stack-label>You have selected the following samples for inclusion in a new Analysis Batch:</clr-stack-label>

                        <ul class="list compact">
                            <li *ngFor="let sample of selected">Sample {{sample.id}} ({{sample.study_string}})</li>
                        </ul>
                        <p>

                            <div class="form-group">
                                <label for="abDescInput">Analysis Batch Description</label>
                                <textarea id="abDescInput" rows="2" formControlName="analysis_batch_description" style="max-width:25em"></textarea>
                            </div>

                            <div class="form-group">
                                <label for="abNotesInput">Analysis Batch Notes</label>
                                <textarea id="abNotesInput" rows="2" formControlName="analysis_batch_notes" style="max-width:25em"></textarea>
                            </div>

                            <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showABCreateError">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Submission error. Analysis Batch not created.</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="onSubmitAB(createABForm.value)">Try again</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <clr-alert [clrAlertType]="'alert-success'" *ngIf="showABCreateSuccess">
                                <div clr-alert-item class="alert-item">
                                    <span class="alert-text">Analysis Batch successfully created</span>
                                    <div class="alert-actions">
                                        <a class="alert-action" (click)="showHideABModal = false; showABCreateSuccess = false">Close</a>
                                    </div>
                                </div>
                            </clr-alert>

                            <button class="btn btn-primary" type="submit" [disabled]="createABForm.invalid" [clrLoading]="submitLoading">Submit</button>
                            <button class="btn btn-info" (click)="showHideEdit = !showHideEdit">Cancel</button>

                    </section>
                </form>

            </div>
            <!--<div class="col-lg-6">
            </div>-->
        </div>
    </div>
    <!--<div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHideEdit = !showHideEdit">Cancel</button>
        <button type="submit" class="btn btn-primary"  [disabled]="editSampleForm.invalid">Save Edits</button>
    </div>-->
</clr-modal>
<!-- end analysis batch modal -->


<!-- begin FCSV modal -->
<clr-modal [(clrModalOpen)]="showHideFCSVModal">
    <h3 class="modal-title">Add Final Concentrated Sample Volume</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-lg-12">

                <form id="createFCSVForm" class="compact" [formGroup]="createFCSVForm" (ngSubmit)="onSubmitFCSV(createFCSVForm.value)">
                    <section class="form-block">

                        <div>
                            <label>You are adding a FCSV to the following samples:</label>
                            <ul class="list">
                                <li *ngFor="let sample of selected">
                                    Sample {{sample.id}}
                                </li>
                            </ul>

                        </div>


                        <div class="form-group">
                            <label for="fcsv">FCSV</label>
                            <input id="fcsv" type="text" formControlName="final_concentrated_sample_volume" size="5">
                            <div class="select">
                                <select id="fcsvUnitSelect" formControlName="final_concentrated_sample_volume_unit">
                                    <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                </select>
                            </div>
                            <label>Note: FCSV is converted to milliliters (mL) for storage and results calculation. </label>
                        </div>

                        <!---->
                        <!-- <div class="form-group">
                            <label for="tvsInput">Total Volume (or mass) Sampled</label>
                            <input type="text" id="tvsInput" formControlName="total_volume_sampled_initial">
                            <div class="select">
                                <select id="tvsUnitSelect" formControlName="total_volume_sampled_unit_initial">
                                    <option *ngFor="let unit of units" [value]="unit.id">{{unit.name}}</option>
                                </select>
                            </div>
                        </div> -->
                        <!---->

                        <div class="form-group">
                            <label class="required">FCSV Type</label>
                            <label for="fcsvTypeSelect" aria-haspopup="true" role="tooltip" class="tooltip tooltip-validation tooltip-sm" [class.invalid]="editSampleForm.get('sample_type').invalid && (editSampleForm.get('sample_type').dirty || editSampleForm.get('sample_type').touched)">
                                <div class="select">
                                    <select id="fcsvTypeSelect" name="fcsv_type" formControlName="final_concentrated_sample_volume_type">
                                        <option *ngFor="let type of concentrationTypes" [value]="type.id">{{type.name}}</option>
                                    </select>
                                </div>
                            </label>
                        </div>

                        <div class="form-group">
                            <label for="fcsvNotesInput">FCSV Notes</label>
                            <textarea id="fcsvNotesInput" rows="2" formControlName="final_concentrated_sample_volume_notes" style="max-width:25em"></textarea>
                        </div>

                        <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showFCSVCreateError">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Submission error. FCSV not submitted.</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="onSubmitAB(createABForm.value)">Try again</a>
                                </div>
                            </div>
                        </clr-alert>

                        <clr-alert [clrAlertType]="'alert-success'" *ngIf="showFCSVCreateSuccess">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">FCSV successfully submitted.</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="showHideFCSVModal = false; showFCSVCreateSuccess = false">Close</a>
                                </div>
                            </div>
                        </clr-alert>

                        <button class="btn btn-primary" type="submit" [disabled]="createFCSVForm.invalid" [clrLoading]="submitLoading">Submit</button>
                        <button class="btn btn-info" (click)="showHideFCSVModal = !showHideFCSVModal">Cancel</button>
                    </section>
                </form>
            </div>
        </div>
    </div>
</clr-modal>
<!-- end FCSV modal -->



<!-- begin freezer location assignment modal -->
<clr-modal [(clrModalOpen)]="showHideFreezerLocationAssignModal">
    <h3 class="modal-title">
        <clr-icon shape="thermometer"></clr-icon> Freezer Location Assignment</h3>
    <div class="modal-body">
        <div class="row">
            <div class="col-lg-12">
                <div *ngIf="this.selectedStudy">
                    <h4>
                        <span>Assigning aliquot count and freezer locations for {{selected.length}} sample
                            <span *ngIf="selected.length > 1">s</span>
                        </span> from the study
                        <span style="font-weight:bold;">{{selectedStudy | displayValue:'name':this.studies}}</span>
                    </h4>
                </div>
                <div *ngIf="showLastOccupiedSpot" class="last-spot-border">
                    <label for="lastOccupiedSpot" style="font-weight:bold;">Last occupied freezer location</label>
                    <div id="lastOccupiedSpot">
                        <span class="spinner spinner-inline" *ngIf="lastOccupiedSpotLoading">Loading...</span>
                        <span *ngIf="showLastOccupiedSpot">
                            <span>
                                Rack
                                <b>{{lastOccupiedSpot.rack}}</b> | Box
                                <b>{{lastOccupiedSpot.box}}</b> | Row
                                <b>{{lastOccupiedSpot.row}}</b> | Spot
                                <b>{{lastOccupiedSpot.spot}}</b>
                            </span>
                            <!-- <ul class="list-unstyled">
                                <li>Rack {{lastOccupiedSpot.rack}}</li>
                                <li>Box {{lastOccupiedSpot.box}}</li>
                                <li>Row {{lastOccupiedSpot.row}}</li>
                                <li>Spot {{lastOccupiedSpot.spot}}</li>
                            </ul> -->
                        </span>
                        <span *ngIf="showLastOccupiedSpotError">
                            <clr-icon shape="error-standard"></clr-icon> Not Available</span>
                    </div>
                </div>
                <form id="freezeSampleForm" class="compact" [formGroup]="freezeSampleForm" (ngSubmit)="onSubmitFreezerLocation(freezeSampleForm.value)">
                    <section class="form-block">

                        <div class="form-group">
                            <label for="freezer" class="required">Freezer</label>
                            <select id="freezerSelect" name="freezer" formControlName="freezer">
                                <option *ngFor="let freezer of freezers" [value]="freezer.id">{{freezer.id}}</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="aliquotCount" class="required">Number of Aliquots</label>
                            <input id="aliquotCount" type="number" formControlName="aliquot_count">
                        </div>
                        <div class="form-group">
                            <label for="rack" class="required">Rack</label>
                            <input id="rack" type="text" formControlName="rack">
                        </div>
                        <div class="form-group">
                            <label for="box" class="required">Box</label>
                            <input id="box" type="text" formControlName="box">
                        </div>
                        <div class="form-group">
                            <label for="row" class="required">Row</label>
                            <input id="row" type="text" formControlName="row">
                        </div>
                        <div class="form-group">
                            <label for="spot" class="required">Spot</label>
                            <input id="spot" type="text" formControlName="spot">
                        </div>
                        <div class="form-group">
                            <label>Frozen</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="frozenToggle" formControlName="frozen">
                                <label for="frozenToggle">{{this.freezeSampleForm.controls.frozen.value ? "Yes" : "No"}}</label>
                            </div>
                        </div>

                        <button type="button" class="btn btn-outline" (click)="showHideFreezerLocationAssignModal = !showHideFreezerLocationAssignModal">Cancel</button>
                        <button type="submit" class="btn btn-primary" [disabled]="freezeSampleForm.invalid" [clrLoading]="submitLoading">Submit</button>

                        <clr-alert [clrAlertType]="'alert-danger'" *ngIf="showFreezeError">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Submission error. Aliquot records not recorded.</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="onSubmitFreezerLocation(freezeSampleForm.value)">Try again</a>
                                </div>
                            </div>
                        </clr-alert>

                        <clr-alert [clrAlertType]="'alert-success'" *ngIf="showFreezeSuccess">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Sample aliquot records and locations successfully submitted.</span>
                                <div class="alert-actions">
                                    <a class="alert-action" (click)="showHideFreezerLocationAssignModal = false; showFreezeSuccess = false">Close</a>
                                </div>
                            </div>
                        </clr-alert>

                    </section>
                </form>
            </div>
        </div>
    </div>
    <div class="modal-footer"></div>
</clr-modal>
<!-- end freezer location assignment modal-->

<!-- begin freezer location lookup modal -->
<clr-modal [(clrModalOpen)]="showHideFreezerLocationLookupModal">
    <h3 class="modal-title">
        <clr-icon shape="thermometer"></clr-icon> Freezer Location Lookup</h3>
    <div class="modal-body">
        <div class="row">
            <div class="col-lg-12">
                <div *ngIf="selected.length > 0">
                    <h4>Showing first aliquot for each selected sample</h4>
                    <table class="table table-compact" style="width: 15em">
                        <thead>
                            <tr>
                                <th class="left">Sample</th>
                                <th class="left">Freezer</th>
                                <th class="left">Rack</th>
                                <th class="left">Box</th>
                                <th class="left">Row</th>
                                <th class="left">Spot</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let sample of selected">
                                <td class="left">{{sample.id}}</td>
                                <td class="left">
                                    <span *ngIf="sample.aliquots[0]">{{sample.aliquots[0].freezer_location.freezer}}</span>
                                </td>
                                <td class="left">
                                    <span *ngIf="sample.aliquots[0]">{{sample.aliquots[0].freezer_location.rack}}</span>
                                </td>
                                <td class="left">
                                    <span *ngIf="sample.aliquots[0]">{{sample.aliquots[0].freezer_location.box}}</span>
                                </td>
                                <td class="left">
                                    <span *ngIf="sample.aliquots[0]">{{sample.aliquots[0].freezer_location.row}}</span>
                                </td>
                                <td class="left">
                                    <span *ngIf="sample.aliquots[0]">{{sample.aliquots[0].freezer_location.spot}}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
    <div class="modal-footer"></div>
</clr-modal>
<!-- end freezer location assignment modal-->

<!-- begin freezer choice modal -->
<clr-modal [(clrModalOpen)]="showHideFreezerChoiceModal">
    <h3 class="modal-title">
        <clr-icon shape="thermometer"></clr-icon> Freezer</h3>
    <div class="modal-body">
        <div class="row">
            <div class="col-lg-12">
                <div>
                    <h4>Sample Aliquot Freezer Location</h4>
                </div>
                <br>
                <div>
                    <button class="btn btn-primary" (click)="assignFreezerLocation(selected)">
                        <clr-icon shape="plus"></clr-icon> Create</button>
                    <button class="btn btn-primary" (click)="lookupFreezerLocation(selected)">
                        <clr-icon shape="search"></clr-icon> Lookup</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer"></div>
</clr-modal>
<!-- end freezer location assignment modal-->

<!-- begin freeze warning modal -->
<clr-modal [(clrModalOpen)]="showHideFreezeWarningModal">
    <h3 class="modal-title">
        <clr-icon shape="warning-standard" class="is-error" size="36"></clr-icon> Multiple Studies Error</h3>
    <div class="modal-body">
        <p>The selected set of samples is associated with more than one study. Please adjust selection.</p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHideFreezeWarningModal = false">Return</button>
    </div>
</clr-modal>
<!-- end freeze warning modal -->

<!-- begin print modal -->
<clr-modal [(clrModalOpen)]="showHidePrintModal" [clrModalSize]="'xl'">
    <h3 class="modal-title">Print Aliquot Labels</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-lg-12">

                <form [formGroup]="skipLabelForm">
                    <section>
                        <div>
                            <label>Number of labels to skip:</label>
                            <input type="number" formControlName="count" class="label-skip-input">
                        </div>

                    </section>
                </form>
                <form>
                    <section class="form-block">
                        <label>Select aliquots to print for each selected sample.</label>
                        <div class="form-group" *ngFor="let sample of selected">
                            <label for="">Sample {{sample.id}}</label>

                            <div *ngIf="sample.aliquots.length === 0">
                                <clr-icon shape="times-circle"></clr-icon> No aliquots recorded for this sample</div>

                            <div *ngIf="sample.aliquots.length > 0">

                                <div class="checkbox-inline" *ngFor="let aliquot of sample.aliquots">
                                    <input type="checkbox" checked [attr.id]="'aliquot' + aliquot.aliquot_string" [value]="aliquot.aliquot_string" (change)="includeExcludeLabel($event.target)">
                                    <label [attr.for]="'aliquot' + aliquot.aliquot_string">{{aliquot.aliquot_string}}</label>
                                    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                </div>


                            </div>
                            <!-- <select name="aliquot_select" (change)="onAliquotSelect(sample.id, $event.target.value)">
                                        <option [value]="">Select</option>
                                        <option *ngFor="let aliquot of sample.aliquots" [value]="aliquot.id">{{aliquot.aliquot_string}}</option>
                                    </select> -->
                        </div>

                    </section>
                </form>

            </div>
            <!--<div class="col-lg-6">
            </div>-->
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHidePrintModal = !showHidePrintModal">Cancel</button>
        <button type="submit" class="btn btn-primary" (click)="createLabelPDF()">
            <clr-icon shape="list"></clr-icon> Preview & Print Labels</button>
    </div>
</clr-modal>
<!-- end print modal -->


<!-- begin Missing FCSV Error Modal -->
<clr-modal [(clrModalOpen)]="showHideMissingFCSVErrorModal">
    <h3 class="modal-title">
        <clr-icon shape="warning-standard" class="is-error" size="36"></clr-icon> Missing FCSV Error</h3>
    <div class="modal-body">
        <p>One or more samples in your selection lacks a value for final concentrated sample volume where one is required. FCSV
            is a prerequisite to creation and storage of aliquots for samples with the matrix water, wastewater, or forage/sediment/soil.
            Please add an FCSV for samples of those matrices in your selection and try again. </p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHideMissingFCSVErrorModal = false">Return</button>
    </div>
</clr-modal>
<!-- end  Missing FCSV Error Modal-->

<!-- begin Multiple SamplesErrorModal -->
<clr-modal [(clrModalOpen)]="showHideMultipleSamplesErrorModal">
    <h3 class="modal-title">
        <clr-icon shape="warning-standard" class="is-error" size="36"></clr-icon> Multiple Samples Error</h3>
    <div class="modal-body">
        <p>You many only freeze one sample at a time. Please reduce your selection to one sample and try again. </p>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showHideMultipleSamplesErrorModal = false">Return</button>
    </div>
</clr-modal>
<!-- end freeze warning modal -->

<!-- begin SampleLabelModal -->
<clr-modal [(clrModalOpen)]="showLabelModal" [clrModalSize]="'xl'">
    <h3 class="modal-title">Sample Label Preview</h3>
    <div class="modal-body">
        <sample-label #sampleLabel></sample-label>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="showLabelModal = !showLabelModal">Cancel</button>
    </div>
</clr-modal>
<!-- end SampleLabelModal -->

<!-- begin samples table -->
<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">


        <clr-datagrid [(clrDgSelected)]="selected" [clrDgLoading]="samplesLoading">

            <clr-dg-action-bar>
                <div class="btn-group">
                    <button class="btn btn-sm btn-secondary" (click)="showHideAdd = !showHideAdd">
                        <clr-icon shape="plus"></clr-icon> Add Sample</button>
                    <button class="btn btn-sm btn-secondary" (click)="showHideAddPegNeg = !showHideAddPegNeg">
                        <clr-icon shape="plus"></clr-icon> Add Peg Neg</button>
                    <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length < 1" (click)="createAB(selected)">
                        <clr-icon shape="plus"></clr-icon> Create Analysis Batch</button>
                    <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length < 1" (click)="createFCSV(selected)">
                        <clr-icon shape="plus"></clr-icon>Add FCSV</button>
                    <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length < 1" (click)="openFreezerChoice()">
                        <clr-icon shape="thermometer"></clr-icon> Freezer</button>
                    <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length < 1" (click)="openPrintLabelModal(selected)">
                        <clr-icon shape="printer"></clr-icon> Print Labels</button>
                    <!-- <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length == 0 || selected.length > 1">
                        <clr-icon shape="trash"></clr-icon> Delete Sample</button> -->
                    <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length == 0 || selected.length > 1" (click)="editSample(selected[0])">
                        <clr-icon shape="note-edit" size="16"></clr-icon> Edit Sample</button>

                </div>
            </clr-dg-action-bar>

            <!-- filter column header for Sample ID -->
            <clr-dg-column [clrDgField]="'sample_id'">
                Sample ID
                <clr-dg-filter [clrDgFilter]="rangeFilter">
                    <range-filter #rangeFilter></range-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column>
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Analysis Batches
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'collaborator_sample_id'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Collaborator Sample ID
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for Study-->
            <!--<clr-dg-column [clrDgField]="'study'">
                         <ng-container *clrDgHideableColumn="{hidden: false}">
                            Study
                        </ng-container>
                    </clr-dg-column>-->

            <!-- filter column header for study -->
            <clr-dg-column [clrDgField]="'study'">
                Study
                <clr-dg-filter [clrDgFilter]="studyFilter">
                    <study-filter #studyFilter></study-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <!-- regular column header for Sample Type-->
            <!--<clr-dg-column [clrDgField]="'sample_type'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                            Sample Type
                        </ng-container>
                    </clr-dg-column>-->

            <!-- filter column header for sample type -->
            <clr-dg-column [clrDgField]="'sample_type'">
                Sample Type
                <clr-dg-filter [clrDgFilter]="sampleTypeFilter">
                    <sample-type-filter #sampleTypeFilter></sample-type-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column style="width:10em" [clrDgField]="'record_type'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Record Type
                </ng-container>
            </clr-dg-column>

            <clr-dg-column style="width:20em" [clrDgField]="'sample_description'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Sample Description
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for matrix type-->
            <!--<clr-dg-column [clrDgField]="'matrix_type'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                            Matrix
                        </ng-container>
                    </clr-dg-column>-->

            <!-- filter column header for matrix type-->
            <clr-dg-column [clrDgField]="'matrix_type'">
                Matrix
                <clr-dg-filter [clrDgFilter]="matrixTypeFilter">
                    <matrix-type-filter #matrixTypeFilter></matrix-type-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column>
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Filtered
                </ng-container>
            </clr-dg-column>

            <clr-dg-column>
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    2° Conc
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'final_concentrated_sample_volume'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    FCSV
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'final_concentrated_sample_volume_type'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    FCSV Type
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'final_concentrated_sample_volume_notes'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    FCSV Notes
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'sample_volume_filtered'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Vol filtered
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'meter_reading_initial'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    IMR
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'meter_reading_final'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    FMR
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'dissolution_volume'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Dissolution Volume (mL)
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'post_dilution_volume'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Volume After Dilution (uL)
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for Study-->
            <!--<clr-dg-column [clrDgField]="'filter_type'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                           Filter Type
                        </ng-container>
                    </clr-dg-column>-->

            <!-- filter column header for study -->
            <clr-dg-column [clrDgField]="'filter_type'">
                Filter Type
                <clr-dg-filter [clrDgFilter]="filterTypeFilter">
                    <filter-type-filter #filterTypeFilter></filter-type-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <!-- regular column header for filter born on date -->
            <!-- <clr-dg-column [clrDgField]="'filter_born_on_date'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                           Filter Born On Date
                        </ng-container>
                    </clr-dg-column> -->

            <!-- filter column header for filter born on date -->
            <clr-dg-column [clrDgField]="'filter_born_on_date'">
                Filter Born On Date
                <clr-dg-filter [clrDgFilter]="filterBornOnDateFilter">
                    <filter-born-on-date-filter [dateField]="'filter_born_on_date'" #filterBornOnDateFilter></filter-born-on-date-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <!-- regular column header for collection start date -->
            <!-- <clr-dg-column [clrDgField]="'collection_start_date'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                           Collect Start Date
                        </ng-container>
                    </clr-dg-column> -->

            <!-- filter column header for collection start date -->
            <clr-dg-column [clrDgField]="'collection_start_date'">
                Collect Start Date
                <clr-dg-filter [clrDgFilter]="CollectionStartDateFilter">
                    <collection-start-date-filter [dateField]="'collection_start_date'" #CollectionStartDateFilter></collection-start-date-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <!-- regular column header for collection end date -->
            <!-- <clr-dg-column [clrDgField]="'collection_end_date'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                           Collect End Date
                        </ng-container>
                    </clr-dg-column> -->

            <!-- filter column header for collection end date -->
            <clr-dg-column [clrDgField]="'collection_end_date'">
                Collect End Date
                <clr-dg-filter [clrDgFilter]="collectionEndDateFilter">
                    <collection-end-date-filter [dateField]="'collection_end_date'" #collectionEndDateFilter></collection-end-date-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'study_site_name'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Study Site Name
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for Sampler name-->
            <!--<clr-dg-column [clrDgField]="'sampler_name'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                           Sampler Name
                        </ng-container>
                    </clr-dg-column>-->

            <!-- filter column header for sampler name -->
            <clr-dg-column [clrDgField]="'sampler_name'">
                Sampler Name
                <clr-dg-filter [clrDgFilter]="samplerNameFilter">
                    <sampler-name-filter #samplerNameFilter></sampler-name-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column style="width:20em" [clrDgField]="'sample_notes'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Sample Notes
                </ng-container>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'created_by'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Added by
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for date added-->
            <!-- <clr-dg-column [clrDgField]="'created_date'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                             Date added
                        </ng-container>
                    </clr-dg-column> -->

            <!-- filter column header for date added -->
            <clr-dg-column [clrDgField]="'created_date'">
                Date Added
                <clr-dg-filter [clrDgFilter]="dateAddedFilter">
                    <date-added-filter [dateField]="'created_date'" #dateAddedFilter></date-added-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-column [clrDgField]="'modified_by'">
                <ng-container *clrDgHideableColumn="{hidden: false}">
                    Updated by
                </ng-container>
            </clr-dg-column>

            <!-- regular column header for date updated-->
            <!-- <clr-dg-column [clrDgField]="'modified_date'">
                        <ng-container *clrDgHideableColumn="{hidden: false}">
                             Date updated
                        </ng-container>
                    </clr-dg-column> -->

            <!-- filter column header for date updated -->
            <clr-dg-column [clrDgField]="'modified_date'">
                Date Updated
                <clr-dg-filter [clrDgFilter]="dateUpdatedFilter">
                    <date-updated-filter [dateField]="'modified_date'" #dateUpdatedFilter></date-updated-filter>
                </clr-dg-filter>
            </clr-dg-column>

            <clr-dg-row *clrDgItems="let sample of allSamples" [clrDgItem]="sample">
                <clr-dg-cell>{{sample.id}}</clr-dg-cell>
                <clr-dg-cell>{{sample.analysisbatches}}</clr-dg-cell>
                <clr-dg-cell>{{sample.collaborator_sample_id}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.studies">{{sample.study_string}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.sampleTypes">{{sample.sample_type_string}}</clr-dg-cell>
                <clr-dg-cell>{{sample.record_type | displayValue:'name':this.recordTypes}}</clr-dg-cell>
                <clr-dg-cell>{{sample.sample_description}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.matrices">{{sample.matrix_type_string}}</clr-dg-cell>
                <clr-dg-cell>{{sample.filter_flag? "Yes" : "No"}}</clr-dg-cell>
                <clr-dg-cell>{{sample.secondary_concentration_flag ? "Yes" : "No"}}</clr-dg-cell>

                <clr-dg-cell>{{sample.final_concentrated_sample_volume}}</clr-dg-cell>
                <clr-dg-cell>{{sample.final_concentrated_sample_volume_type}}</clr-dg-cell>
                <clr-dg-cell>{{sample.final_concentrated_sample_volume_notes}}</clr-dg-cell>

                <clr-dg-cell *ngIf="this.units">{{sample.sample_volume_filtered}} {{sample.total_volume_sampled_unit_initial | displayValue:'name':this.units}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.units">{{sample.meter_reading_initial}} {{sample.meter_reading_unit | displayValue:'name':this.units}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.units">{{sample.meter_reading_final}} {{sample.meter_reading_unit | displayValue:'name':this.units}}</clr-dg-cell>
                <clr-dg-cell>{{sample.dissolution_volume}}</clr-dg-cell>
                <clr-dg-cell>{{sample.post_dilution_volume}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.filterTypes">{{sample.filter_type_string}}</clr-dg-cell>
                <clr-dg-cell>{{sample.filter_born_on_date | date:'shortDate'}}</clr-dg-cell>
                <clr-dg-cell>{{sample.collection_start_date | date:'shortDate'}}</clr-dg-cell>
                <clr-dg-cell>{{sample.collection_end_date | date:'shortDate'}}</clr-dg-cell>
                <clr-dg-cell>{{sample.study_site_name}}</clr-dg-cell>
                <clr-dg-cell *ngIf="this.users">{{sample.sampler_name.name}}</clr-dg-cell>
                <clr-dg-cell>{{sample.sample_notes}}</clr-dg-cell>
                <clr-dg-cell>{{sample.created_by}}</clr-dg-cell>
                <clr-dg-cell>{{sample.created_date | date:'shortDate'}}</clr-dg-cell>
                <clr-dg-cell>{{sample.modified_by }}</clr-dg-cell>
                <clr-dg-cell>{{sample.modified_date | date:'shortDate'}}</clr-dg-cell>
            </clr-dg-row>

            <clr-dg-footer>
                {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}} samples
                <clr-dg-pagination #pagination [clrDgPageSize]="20"></clr-dg-pagination>
            </clr-dg-footer>
        </clr-datagrid>
    </div>
</div>
<!-- end samples table -->