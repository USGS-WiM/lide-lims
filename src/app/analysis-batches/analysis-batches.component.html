<!--may not need a create AB button, creation will be done from samples page -->
<!-- <div class="row">
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class="btn-group">
            <button class="btn btn-sm" (click)="showHideAdd = !showHideAdd">Create New Analysis Batch</button>
        </div>
    </div>
</div> -->

<!-- begin extraction detail modal -->
<clr-modal [(clrModalOpen)]="showHideExtractionDetailModal" [clrModalSize]="'m'">
    <h3 class="modal-title">Extraction Details</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-sm-12">

                <clr-stack-view>
                    <clr-stack-header>Extractions in Analysis Batch {{focusAnalysisBatchID}} </clr-stack-header>

                    <clr-stack-block *ngFor="let extraction of extractionDetailArray">
                        <clr-stack-label>Extraction # {{extraction.extraction_no}}</clr-stack-label>
                        <clr-stack-content></clr-stack-content>
                        <clr-stack-block>
                            <clr-stack-label>Extraction Volume</clr-stack-label>
                            <clr-stack-content>{{extraction.extraction_volume}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Elution Volume</clr-stack-label>
                            <clr-stack-content>{{extraction.elution_volume}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Extraction Method</clr-stack-label>
                            <clr-stack-content>{{extraction.extraction_method}}</clr-stack-content>
                        </clr-stack-block>
                    </clr-stack-block>

                </clr-stack-view>

            </div>
        </div>



    </div>
    <!--<div class="modal-footer">        </div>-->
</clr-modal>
<!-- end extraction detail modal -->

<!-- begin inhibition detail modal -->
<clr-modal [(clrModalOpen)]="showHideInhibitionDetailModal" [clrModalSize]="'m'">
    <h3 class="modal-title">Inhibition Details</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-sm-12">

                <clr-stack-view>
                    <clr-stack-header>Inhibitions in Analysis Batch {{focusAnalysisBatchID}} </clr-stack-header>

                    <clr-stack-block *ngFor="let inhibition of inhibitionDetailArray">
                        <clr-stack-label>Inhibition {{inhibition.id}}</clr-stack-label>
                        <clr-stack-content></clr-stack-content>
                        <clr-stack-block>
                            <clr-stack-label>Inhibition Date</clr-stack-label>
                            <clr-stack-content>{{inhibition.insert_date | date:'shortDate'}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Type</clr-stack-label>
                            <clr-stack-content>{{inhibition.type}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Dilution</clr-stack-label>
                            <clr-stack-content>{{inhibition.dilution}}</clr-stack-content>
                        </clr-stack-block>
                    </clr-stack-block>

                </clr-stack-view>

            </div>
        </div>
    </div>
    <!--<div class="modal-footer">        </div>-->
</clr-modal>
<!-- end inhibition detail modal -->

<!-- begin RT detail modal -->
<clr-modal [(clrModalOpen)]="showHideRTDetailModal" [clrModalSize]="'m'">
    <h3 class="modal-title">RT Details</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-sm-12">

                <clr-stack-view>
                    <clr-stack-header>RTs in Analysis Batch {{focusAnalysisBatchID}} </clr-stack-header>

                    <clr-stack-block *ngFor="let rt of rtDetailArray" [clrSbExpanded]="true">
                        <clr-stack-label>RT # {{rt.reverse_transcription_no}}</clr-stack-label>
                        <clr-stack-content></clr-stack-content>
                        <clr-stack-block [clrSbExpanded]="true">
                            <clr-stack-label>Volume In</clr-stack-label>
                            <clr-stack-content>{{rt.vol_in}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block [clrSbExpanded]="true">
                            <clr-stack-label>Volume Out</clr-stack-label>
                            <clr-stack-content>{{rt.vol_out}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block [clrSbExpanded]="true">
                            <clr-stack-label>Cq Value</clr-stack-label>
                            <clr-stack-content>{{rt.rt_cq}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block [clrSbExpanded]="true">
                                <clr-stack-label>Date</clr-stack-label>
                                <clr-stack-content>{{rt.insert_date | date:'shortDate' }}</clr-stack-content>
                            </clr-stack-block>
                    </clr-stack-block>

                </clr-stack-view>

            </div>
        </div>
    </div>
    <!--<div class="modal-footer">        </div>-->
</clr-modal>
<!-- end RTdetail modal -->



<!-- begin target detail modal -->
<clr-modal [(clrModalOpen)]="showHideTargetDetailModal" [clrModalSize]="'m'">
    <h3 class="modal-title">Extraction Details</h3>
    <div class="modal-body">

        <div class="row">
            <div class="col-sm-12">

                <clr-stack-view>
                    <clr-stack-header>Extractions in Analysis Batch {{focusAnalysisBatchID}} </clr-stack-header>

                    <clr-stack-block *ngFor="let item of focusDetailObject">
                        <clr-stack-label>Extraction {{item.extraction_no}}</clr-stack-label>
                        <clr-stack-content></clr-stack-content>
                        <clr-stack-block>
                            <clr-stack-label>Extraction Volume</clr-stack-label>
                            <clr-stack-content>{{item.extraction_volume}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Elution Volume</clr-stack-label>
                            <clr-stack-content>{{item.elution_volume}}</clr-stack-content>
                        </clr-stack-block>
                        <clr-stack-block>
                            <clr-stack-label>Extraction Method</clr-stack-label>
                            <clr-stack-content>{{item.extraction_method}}</clr-stack-content>
                        </clr-stack-block>
                    </clr-stack-block>

                </clr-stack-view>

            </div>
        </div>
    </div>
    <!--<div class="modal-footer">        </div>-->
</clr-modal>
<!-- end target detail modal -->


<!-- begin Analysis batches table -->
<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card">
            <div class="card-block">
                <div class="card-title">
                    All Analysis Batches
                </div>
                <div class="card-text">
                    <clr-datagrid [(clrDgSelected)]="selected">

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length == 0 || selected.length > 1" (click)="editAB(selected[0])"><clr-icon shape="note-edit"size="16"></clr-icon> Edit Analysis Batch</button>
                                <button type="button" class="btn btn-sm btn-secondary" [disabled]="selected.length < 1"><clr-icon shape="login"></clr-icon> Extract</button>
                                <!--<button type="button" class="btn btn-sm btn-secondary" ><clr-icon shape="printer"></clr-icon> Go</button>
                                <button type="button" class="btn btn-sm btn-secondary" > <clr-icon shape="trash"></clr-icon> Up</button>
                                <button type="button" class="btn btn-sm btn-secondary" ><clr-icon shape="note-edit"size="16"></clr-icon> Here</button> -->

                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch_id'">
                            Analysis Batch ID
                            <clr-dg-filter [clrDgFilter]="rangeFilter">
                                <range-filter #rangeFilter></range-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'ab_description'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch Description
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'studies'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Studies
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extractions'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extractions
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibitions'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Inhibitions
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'rts'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RTs
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'targets'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Targets
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column>
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analaysis Batch Notes
                            </ng-container>
                        </clr-dg-column>


                        <!-- <clr-dg-column>
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Samples
                            </ng-container>
                        </clr-dg-column> -->

                        <clr-dg-column [clrDgField]="'insert_user'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Added by
                            </ng-container>
                        </clr-dg-column>

                        <!-- filter column header for date added -->
                        <clr-dg-column [clrDgField]="'insert_date'">
                            Date Added
                            <clr-dg-filter [clrDgFilter]="dateAddedFilter">
                                <date-added-filter [dateField]="'insert_date'" #dateAddedFilter></date-added-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'update_user'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Updated by
                            </ng-container>
                        </clr-dg-column>

                        <!-- filter column header for date updated -->
                        <clr-dg-column [clrDgField]="'update_date'">
                            Date Updated
                            <clr-dg-filter [clrDgFilter]="dateUpdatedFilter">
                                <date-updated-filter [dateField]="'update_date'" #dateUpdatedFilter></date-updated-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <!-- begin data table rows -->

                        <clr-dg-row *clrDgItems="let ab of allAnalysisBatchSummaries" [clrDgItem]="ab">

                            <clr-dg-cell>{{ab.id}}</clr-dg-cell>
                            <clr-dg-cell>{{ab.analysis_batch_description}}</clr-dg-cell>
                            <clr-dg-cell>{{ab.studies}}</clr-dg-cell>

                            <clr-dg-cell>
                                <a (click)="openExtractionDetails(ab.id)" class="label label-blue clickable">{{ab.extraction_count}}</a>
                            </clr-dg-cell>

                            <clr-dg-cell>
                                <a (click)="openInhibitionDetails(ab.id)" class="label label-blue clickable">{{ab.inhibition_count}}</a>
                            </clr-dg-cell>

                            <clr-dg-cell>
                                <a (click)="openRTDetails(ab.id)"class="label label-blue clickable">{{ab.reverse_transcription_count}}</a>
                            </clr-dg-cell>

                            <clr-dg-cell><a href="" class="label label-blue clickable">{{ab.target_count}}</a></clr-dg-cell>

                            <clr-dg-cell>{{ab.analysis_batch_notes}}</clr-dg-cell>
                            <clr-dg-cell>{{ab.insert_user}}</clr-dg-cell>
                            <clr-dg-cell>{{ab.insert_date | date:'shortDate'}}</clr-dg-cell>
                            <clr-dg-cell>{{ab.update_user }}</clr-dg-cell>
                            <clr-dg-cell>{{ab.update_date | date:'shortDate'}}</clr-dg-cell>

                            <analysis-batch-detail *clrIfExpanded [selectedAnalysisBatch]="ab" ngProjectAs="clr-dg-row-detail"></analysis-batch-detail>

                        </clr-dg-row>

                        <clr-dg-footer>
                            {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}} samples
                            <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end samples table -->