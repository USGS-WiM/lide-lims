<div class="row">
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <h3>Reports</h3>
    </div>
</div>
<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <p>
            <button class="btn btn-outline" (click)="openReportsQueryWizard()">
                <clr-icon shape="search"></clr-icon> Open Reports Query Builder
            </button>

    </div>
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

            <clr-wizard #reportsQueryWizard [(clrWizardOpen)]="reportsQueryWizardActive">
                <clr-wizard-title>Reports Query Builder</clr-wizard-title>

                <clr-wizard-button [type]="'cancel'">Cancel</clr-wizard-button>
                <clr-wizard-button [type]="'previous'">Back</clr-wizard-button>
                <clr-wizard-button [type]="'next'">Next</clr-wizard-button>
                <clr-wizard-button [type]="'finish'">Finish</clr-wizard-button>

                <clr-wizard-page (clrWizardPageCustomButton)="doCustomClick($event)">
                    <ng-template clrPageTitle>Select Samples</ng-template>

                    <!-- Begin sample query form -->
                    <div class="card-text">
                        <form class="form compact" [formGroup]="sampleQueryForm"
                            (ngSubmit)="onSubmitSampleQuery(sampleQueryForm.value)">
                            <section class="form-block">

                                <div class="form-group">
                                    <label [ngClass]="{'required': sampleQueryForm.get('study').enabled}">Study</label>
                                    <label for="studySelect" aria-haspopup="true" role="tooltip"
                                        class="tooltip tooltip-validation tooltip-sm"
                                        [class.invalid]="sampleQueryForm.get('study').invalid && (sampleQueryForm.get('study').dirty || sampleQueryForm.get('study').touched)">
                                        <div class="select">
                                            <select id="studySelect" name="study" formControlName="study">
                                                <option value="">
                                                    <span class="all">ALL STUDIES</span>
                                                </option>
                                                <option *ngFor="let study of studies" [value]="study.id">{{study.name}}
                                                </option>
                                            </select>
                                        </div>
                                    </label>
                                </div>

                                <div class="form-group">
                                    <label>Sample ID Range</label>
                                    <span>From</span>
                                    <input type="number" formControlName="from_id">
                                    <span>To</span>
                                    <input type="number" formControlName="to_id">
                                </div>

                                <div class="form-group">
                                    <label>Collection Start Date Range</label>
                                    <span>From</span>
                                    <input type="date" formControlName="from_collection_start_date">
                                    <span>To</span>
                                    <input type="date" formControlName="to_collection_start_date">
                                </div>

                                <div class="form-group">
                                    <label>Collaborator Sample ID</label>
                                    <input id="collabSampleIdInput" type="text"
                                        formControlName="collaborator_sample_id">
                                </div>

                                <div class="form-group">
                                    <label>Peg Neg (returns associated samples)</label>
                                    <input type="number" formControlName="peg_neg">
                                </div>
                                <!-- <div class="form-group">
                                    <label>Matrix</label>
                                    <div class="select">
                                        <select id="matrixSelect" name="matrix" formControlName="matrix">
                                            <option value="">
                                                <span class="all">ALL MATRICES</span>
                                            </option>
                                            <option *ngFor="let matrix of matrices" [value]="matrix.id">{{matrix.name}}</option>
                                        </select>
                                    </div>
                                </div>
    
                                <div class="form-group">
                                    <label>Sample type</label>
                                    <div class="select">
                                        <select id="sampleTypeSelect" name="sample_type" formControlName="sample_type">
                                            <option value="">
                                                <span class="all">ALL SAMPLE TYPES</span>
                                            </option>
                                            <option *ngFor="let sampleType of sampleTypes" [value]="sampleType.id">{{sampleType.name}}</option>
                                        </select>
                                    </div>
                                </div> -->

                            </section>

                            <clr-alert [clrAlertType]="'alert-danger'" *ngIf="sampleQuerySizeErrorFlag">
                                <div class="alert-item">
                                    <span class="alert-text">Your query results are too large (greater than
                                        {{queryCountLimit}}). Please narrow your search.</span>
                                </div>
                            </clr-alert>

                            <button class="btn btn-primary" type="submit" [clrLoading]="submitLoading">
                                <clr-icon shape="filter"></clr-icon> Filter Samples
                            </button>
                        </form>
                    </div>

                    <div *ngIf="sampleQueryComplete">
                        <h4>Query returned {{samplesCount}} sample records</h4>
                    </div>
                    <!-- End sample query form -->


                    <div class="in-wizard-datagrid">
                        <clr-datagrid [(clrDgSelected)]="selected" [clrDgLoading]="samplesLoading"
                            [clDgRowSelection]="true" class="datagrid-compact">

                            <clr-dg-action-bar>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-sm btn-secondary" (click)="deselectAll()">
                                        <clr-icon shape="window-close" size="16"></clr-icon> Deselect All
                                    </button>
                                </div>
                            </clr-dg-action-bar>

                            <clr-dg-column [clrDgField]="'id'">
                                Sample ID
                                <clr-dg-filter [clrDgFilter]="rangeFilter">
                                    <range-filter #rangeFilter></range-filter>
                                </clr-dg-filter>
                            </clr-dg-column>

                            <clr-dg-column [clrDgField]="'collaborator_sample_id'">
                                <ng-container *clrDgHideableColumn="{hidden: false}">
                                    Collaborator Sample ID
                                </ng-container>
                            </clr-dg-column>

                            <clr-dg-column [clrDgField]="'study_string'">
                                Study
                                <clr-dg-filter [clrDgFilter]="studyFilter">
                                    <study-filter #studyFilter></study-filter>
                                </clr-dg-filter>
                            </clr-dg-column>


                            <clr-dg-column [clrDgField]="'collection_start_date'">
                                Collect Start Date
                                <clr-dg-filter [clrDgFilter]="CollectionStartDateFilter">
                                    <collection-start-date-filter [dateField]="'collection_start_date'"
                                        #CollectionStartDateFilter></collection-start-date-filter>
                                </clr-dg-filter>
                            </clr-dg-column>

                            <clr-dg-row *clrDgItems="let sample of allSamples" [clrDgItem]="sample">
                                <clr-dg-cell>{{sample.id}}</clr-dg-cell>
                                <clr-dg-cell>{{sample.collaborator_sample_id}}</clr-dg-cell>
                                <clr-dg-cell>{{sample.study_string}}</clr-dg-cell>
                                <clr-dg-cell>{{sample.collection_start_date | date:'shortDate'}}</clr-dg-cell>
                            </clr-dg-row>

                            <clr-dg-footer>
                                {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}}
                                samples
                                <clr-dg-pagination #pagination [clrDgPageSize]="10"></clr-dg-pagination>
                            </clr-dg-footer>
                        </clr-datagrid>

                    </div>
                    <p>
                        <clr-alert [clrAlertType]="'alert-danger'" *ngIf="sampleSelectErrorFlag">
                            <div clr-alert-item class="alert-item">
                                <span class="alert-text">Please select at least one sample to continue.</span>
                            </div>
                        </clr-alert>

                        <ng-template clrPageButtons>
                            <clr-wizard-button [type]="'custom-cancel'">Cancel</clr-wizard-button>
                            <clr-wizard-button [type]="'custom-previous'">Back</clr-wizard-button>
                            <clr-wizard-button [type]="'custom-next-sampleSelect'">Next</clr-wizard-button>
                        </ng-template>
                </clr-wizard-page>

                <clr-wizard-page (clrWizardPageCustomButton)="doCustomClick($event)">
                    <ng-template clrPageTitle>Select Targets</ng-template>
                    <div class="in-wizard-datagrid">
                        <clr-datagrid [(clrDgSelected)]="selected" [clDgRowSelection]="true" class="datagrid-compact">

                            <clr-dg-column [clrDgField]="'name'">Name</clr-dg-column>
                            <clr-dg-column [clrDgField]="'code'">Code</clr-dg-column>
                            <clr-dg-column [clrDgField]="'type'">Type</clr-dg-column>

                            <clr-dg-row *clrDgItems="let target of allTargets" [clrDgItem]="target">
                                <clr-dg-cell>{{target.name}}</clr-dg-cell>
                                <clr-dg-cell>{{target.code}}</clr-dg-cell>
                                <clr-dg-cell>{{target.nucleic_acid_type | displayValue:'name':this.nucleicAcidTypes }}
                                </clr-dg-cell>
                            </clr-dg-row>

                            <clr-dg-footer>{{allTargets.length}} targets</clr-dg-footer>
                        </clr-datagrid>
                    </div>
                    <clr-alert [clrAlertType]="'alert-danger'" *ngIf="targetSelectErrorFlag">
                        <div clr-alert-item class="alert-item">
                            <span class="alert-text">Please select at least one target to continue.</span>
                        </div>
                    </clr-alert>
                    <ng-template clrPageButtons>
                        <clr-wizard-button [type]="'custom-cancel'">Cancel</clr-wizard-button>
                        <clr-wizard-button [type]="'custom-previous'">Back</clr-wizard-button>
                        <clr-wizard-button [type]="'custom-next-targetSelect'">Next</clr-wizard-button>
                    </ng-template>
                </clr-wizard-page>

                <clr-wizard-page (clrWizardPageCustomButton)="doCustomClick($event)">
                    <ng-template clrPageTitle>Query Summary</ng-template>
                    <label>Samples:</label>
                    <ul>
                        <li *ngFor="let sample of reportsQuery.samples">{{sample}}</li>
                    </ul>
                    <p>
                        <label>Targets:</label>
                        <ul>
                            <li *ngFor="let target of reportsQuery.targets">{{target | displayValue:'name': allTargets}}
                            </li>
                        </ul>

                        <ng-template clrPageButtons>
                            <clr-wizard-button [type]="'cancel'">Cancel</clr-wizard-button>
                            <clr-wizard-button [type]="'custom-previous'">Back</clr-wizard-button>
                            <clr-wizard-button [type]="'custom-finish'">Finish</clr-wizard-button>
                        </ng-template>

                </clr-wizard-page>
            </clr-wizard>

        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card">
            <div class="card-header">Current Query</div>
            <div class="card-block" *ngIf="reportsQuery.samples.length === 0 && reportsQuery.targets.length === 0">
                No Samples or Targets Selected
            </div>
            <div class="card-block" *ngIf="reportsQuery.samples.length > 0 || reportsQuery.targets.length > 0">
                <div class="card-title">Samples</div>
                <div class="row list-section">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 list">
                        <!-- <label class="text-larger">Samples:&nbsp;</label> -->
                        <label></label><span *ngIf="reportsQuery.samples.length === 0">No Samples Selected </span><span
                            *ngFor="let sample of reportsQuery.samples"
                            class="label list-item">{{sample}}&nbsp;</span><br>
                    </div>
                </div>
                <div class="card-title">Targets</div>
                <div class="row list-section">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 list">
                        <!-- <label class="text-larger text-purple">Targets:&nbsp;</label> -->
                        <label></label><span *ngIf="reportsQuery.targets.length === 0">No Targets Selected </span><span
                            *ngFor="let target of reportsQuery.targets"
                            class="label label-purple list-item">{{target | displayValue:'name': allTargets}}&nbsp;</span>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card">
            <div class="card-header">Report Selection</div>
            <div class="card-block">

                <form [formGroup]="reportSelectForm">
                    <section class="form-block">
                        <!-- <label>Choose Report(s)</label> -->
                        <div class="form-group">
                            <label>Choose Report(s)</label>

                            <!-- <div class="checkbox">
                                <input type="checkbox" id="inhibitionReport" formControlName="inhibition_report">
                                <label for="inhibitionReport">Inhibition Report</label><br><span
                                    class="text-italic">Requires Sample
                                    selection</span>
                            </div>
                            <div class="checkbox">
                                <input type="checkbox" id="resultsReportSummary"
                                    formControlName="results_report_summary">
                                <label for="resultsReportSummary">Results Report Summary</label><br><span
                                    class="text-italic">Requires
                                    Sample and Target selection</span>
                            </div>
                            <div class="checkbox">
                                <input type="checkbox" id="individualSampleReport"
                                    formControlName="individual_sample_report">
                                <label for="individualSampleReport">Individual Sample Report</label><br><span
                                    class="text-italic">Requires
                                    Sample and Target selection</span>
                            </div>
                            <div class="checkbox">
                                <input type="checkbox" id="qualityControlReport"
                                    formControlName="quality_control_report">
                                <label for="qualityControlReport">Quality Control Report</label><br><span
                                    class="text-italic">Requires
                                    Sample selection</span>
                            </div>
                            <div class="checkbox">
                                <input type="checkbox" id="controlResultsReport"
                                    formControlName="controls_result_report">
                                <label for="controlResultsReport">Controls Results Report</label><br><span
                                    class="text-italic">Requires
                                    Sample and Target selection</span>
                            </div> -->

                            <clr-checkbox formControlName="inhibition_report"
                                [clrDisabled]="reportsQuery.samples.length < 1">
                                Inhibition Report
                            </clr-checkbox><br><span class="text-italic">Requires
                                Sample selection</span>

                            <clr-checkbox formControlName="results_report_summary"
                                [clrDisabled]="reportsQuery.samples.length < 1 || reportsQuery.targets.length < 1">
                                Results Report Summary
                            </clr-checkbox><br><span class="text-italic">Requires
                                Sample and Target selection</span>

                            <div class="card" *ngIf="reportSelectForm.value.results_report_summary"
                                formGroupName="results_report_summary_options">
                                <div class="card-block">
                                    <div class="card-title">
                                        <span class="text-smaller">Results Report Summary Statistics Options</span>
                                    </div>
                                    <div class="card-text">
                                        <clr-checkbox [clrInline]="true" formControlName="replicate_count">
                                            Rep Count
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="positive_count">
                                            Positive Rep Count
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="percent_positive">
                                            Percent Positive
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="max_concentration">
                                            Max Concentration
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="min_concentration">
                                            Min Concentration
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="median_concentration">
                                            Median Concentration
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="average_concentration">
                                            Average Concentration
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true" formControlName="min_concentration_positive">
                                            Min concentration positive reps
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true"
                                            formControlName="median_concentration_positive">
                                            Median concentration positive reps
                                        </clr-checkbox>
                                        <clr-checkbox [clrInline]="true"
                                            formControlName="average_concentration_positive">
                                            Average concentration positive reps
                                        </clr-checkbox>
                                    </div>


                                </div>
                            </div>

                            <clr-checkbox formControlName="individual_sample_report"
                                [clrDisabled]="reportsQuery.samples.length < 1 || reportsQuery.targets.length < 1">
                                Individual Sample Report
                            </clr-checkbox><br><span class="text-italic">Requires
                                Sample and Target selection</span>

                            <clr-checkbox formControlName="quality_control_report"
                                [clrDisabled]="reportsQuery.samples.length < 1">
                                Quality Control Report
                            </clr-checkbox><br><span class="text-italic">Requires
                                Sample selection</span>

                            <clr-checkbox formControlName="controls_result_report"
                                [clrDisabled]="reportsQuery.samples.length < 1 || reportsQuery.targets.length < 1">
                                Controls Results Report
                            </clr-checkbox><br><span class="text-italic">Requires
                                Sample and Target selection</span>


                        </div>

                        <button class="btn btn-primary" (click)="generateReports(reportSelectForm.value)"
                            [clrLoading]="submitLoading">Generate
                            Reports</button>
                    </section>
                </form>

            </div>
        </div>
    </div>
</div>

<div class="row">
    <!---------- Loading spinner---------->
    <span class="spinner spinner-lg" *ngIf="reportsLoading">
        Generating reports...
    </span>
    <!---------- End Loading spinner---------->
</div>

<div class="row">

    <!-- <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" *ngIf="fsmcResultsLoaded">
        There are no results for your query.
    </div> -->

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"
        *ngIf=" inhibitionReportLoaded || controlsResultReportLoaded || individualSampleReportLoaded || qualityControlReportLoaded || resultsReportSummaryLoaded">

        <clr-tabs>

            <!--Inhibition Report tab -->
            <clr-tab>
                <button clrTabLink (mouseout)="resizeTable('inhibitionReport')">Inhibition Report</button>
                <clr-tab-content (mouseover)="resizeTable('inhibitionReport')">

                    <clr-datagrid [clrDgLoading]="inhibitionReportLoading" #inhibitionReportDataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('inhibitionReport')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="inhibition_report_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'sample'">
                            Sample ID
                            <clr-dg-filter [clrDgFilter]="rangeFilter">
                                <range-filter #rangeFilter></range-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'collaborator_sample_id'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Collaborator Sample ID
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'study'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Study
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_dna_cq_value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                DNA Inhibtion Sample Cq
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_dna_control_cq_value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                DNA Inhibtion Control Cq
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_dna_dilution_factor'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                DNA Inhibtion Dilution Factor
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_rna_cq_value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RNA Inhibtion Sample Cq
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_rna_control_cq_value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RNA Inhibtion Control Cq
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'inhibition_rna_dilution_factor'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RNA Inhibtion Dilution Factor
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *clrDgItems="let item of inhibitionReportResults" [clrDgItem]="item">
                            <clr-dg-cell>{{item.sample}}</clr-dg-cell>
                            <clr-dg-cell>{{item.collaborator_sample_id}}</clr-dg-cell>
                            <clr-dg-cell>{{item.study}}</clr-dg-cell>
                            <clr-dg-cell>{{item.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{item.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_dna_cq_value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_dna_control_value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_dna_dilution_factor}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_rna_cq_value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_rna_control_value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.inhibition_rna_dilution_factor}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{inhibitionPagination.firstItem + 1}} - {{inhibitionPagination.lastItem + 1}} of
                            {{inhibitionPagination.totalItems}}
                            results
                            <clr-dg-pagination #inhibitionPagination [clrDgPageSize]="10"></clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                </clr-tab-content>
            </clr-tab>
            <!--End Inhibition Report tab -->

            <!--Results Report Summary tab -->
            <clr-tab>
                <button clrTabLink (mouseout)="resizeTable('resultsReportSummary')">Results Report Summary</button>
                <clr-tab-content (mouseover)="resizeTable('resultsReportSummary')">

                    <clr-datagrid [clrDgLoading]="resultsReportSummaryLoading" #resultsReportSummaryDataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('resultsReportSummary')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="results_report_summary_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'target_name'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Target
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'replicate_count'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('replicate_count').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Replicate Count
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'positive_count'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('positive_count').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Positive Count
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'percent_positive'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('percent_positive').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Percent Positive
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'max_concentration'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('max_concentration').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Max Concentration
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'min_concentration'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('min_concentration').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Min Concentration
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'median_concentration'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('median_concentration').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Median Concentration
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'average_concentration'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('average_concentration').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Average Concentration
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'min_concentration_positive'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('min_concentration_positive').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Minimum concentration of positive replicates
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'median_concentration_positive'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('median_concentration_positive').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Median concentration of positive replicates
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'average_concentration_positive'"
                            *ngIf="reportSelectForm.get('results_report_summary_options').get('average_concentration_positive').value">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Average concentration of positive replicates
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *clrDgItems="let item of resultsReportSummaryResults" [clrDgItem]="item">
                            <clr-dg-cell>{{item.target_name}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('replicate_count').value">
                                {{item.replicate_count}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('positive_count').value">
                                {{item.positive_count}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('percent_positive').value">
                                {{item.percent_positive}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('max_concentration').value">
                                {{item.max_concentration}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('min_concentration').value">
                                {{item.min_concentration}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('median_concentration').value">
                                {{item.median_concentration}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('average_concentration').value">
                                {{item.average_concentration}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('min_concentration_positive').value">
                                {{item.min_concentration_positive}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('median_concentration_positive').value">
                                {{item.median_concentration_positive}}</clr-dg-cell>
                            <clr-dg-cell
                                *ngIf="reportSelectForm.get('results_report_summary_options').get('average_concentration_positive').value">
                                {{item.average_concentration_positive}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{resultsReportPagination.firstItem + 1}} - {{resultsReportPagination.lastItem + 1}} of
                            {{resultsReportPagination.totalItems}}
                            results
                            <clr-dg-pagination #resultsReportPagination [clrDgPageSize]="10"></clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                </clr-tab-content>
            </clr-tab>
            <!-- End Results Report Summary tab -->

            <!-- Individual Sample Report tab -->
            <clr-tab>
                <button clrTabLink (mouseout)="resizeTable('individualSampleReport')">Individual Sample Report</button>
                <clr-tab-content class="sample-results-tab" (mouseover)="resizeTable('individualSampleReport')">

                    <clr-datagrid [clrDgLoading]="individualSampleReportLoading" #individualSampleReportDataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('individualSampleReport')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="individual_sample_report_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'id'">
                            Sample ID
                            <clr-dg-filter [clrDgFilter]="rangeFilter">
                                <range-filter #rangeFilter></range-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'target_string'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Target
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'result'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Result
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'final_sample_mean_concentration'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Sample Mean Concentration (Sci)
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *ngFor="let item of individualSampleReportResults" [clrDgItem]="item">
                            <clr-dg-cell>{{item.sample}}</clr-dg-cell>
                            <clr-dg-cell>{{item.target_string}}</clr-dg-cell>
                            <clr-dg-cell>{{item.result}}</clr-dg-cell>
                            <clr-dg-cell>{{item.final_sample_mean_concentration_sci}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{individualSamplePagination.firstItem + 1}} - {{individualSamplePagination.lastItem + 1}}
                            of
                            {{individualSamplePagination.totalItems}}
                            results
                            <clr-dg-pagination #individualSamplePagination [clrDgPageSize]="10"></clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                </clr-tab-content>
            </clr-tab>
            <!-- End Individual Sample Report tab -->

            <!--Quality Control Report tab -->
            <clr-tab>
                <button clrTabLink (mouseout)="resizeTable('qualityControlReport')">Quality Control Report</button>
                <clr-tab-content (mouseover)="resizeTable('qualityControlReport')">

                    <h4>Sample-level summary statistics</h4>
                    <clr-datagrid [clrDgLoading]="qualityControlReportLoading" #qualityControlReport_sampleQC_DataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('qualityControlReport_sampleQC')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="quality_control_report_sampleQC_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'metric'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Metric
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Value
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'count'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Count
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'min'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Min
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'max'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Max
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *ngFor="let item of qualityControlReportResults.sample_quality_control"
                            [clrDgItem]="item">
                            <clr-dg-cell>{{item.metric}}</clr-dg-cell>
                            <clr-dg-cell>{{item.value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.count}}</clr-dg-cell>
                            <clr-dg-cell>{{item.min}}</clr-dg-cell>
                            <clr-dg-cell>{{item.max}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{qualityControlReport_sampleQCPagination.firstItem + 1}} -
                            {{qualityControlReport_sampleQCPagination.lastItem + 1}} of
                            {{qualityControlReport_sampleQCPagination.totalItems}}
                            results
                            <clr-dg-pagination #qualityControlReport_sampleQCPagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>Extraction-level raw values</h4>
                    <clr-datagrid [clrDgLoading]="qualityControlReportLoading" #qualityControlReport_EB_Raw_DataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('qualityControlReport_EB_Raw')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="quality_control_report_EB_Raw_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'elution_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Elution Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'rt_template_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RT Template Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'rt_reaction_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                RT Reaction Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'qpcr_template_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                qPCR Template Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'qpcr_reaction_volume'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                qPCR Reaction Volume
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *ngFor="let item of qualityControlReportResults.extraction_raw_data"
                            [clrDgItem]="item">
                            <clr-dg-cell>{{item.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{item.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell>{{item.extraction_volume}}</clr-dg-cell>
                            <clr-dg-cell>{{item.elution_volume}}</clr-dg-cell>
                            <clr-dg-cell>{{item.rt_template_volume}}</clr-dg-cell>
                            <clr-dg-cell>{{item.rt_reaction_volume}}</clr-dg-cell>
                            <clr-dg-cell>{{item.qpcr_template_volume}}</clr-dg-cell>
                            <clr-dg-cell>{{item.qpcr_reaction_volume}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{qualityControlReport_EB_Raw_Pagination.firstItem + 1}} -
                            {{qualityControlReport_EB_Raw_Pagination.lastItem + 1}} of
                            {{qualityControlReport_EB_Raw_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #qualityControlReport_EB_Raw_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>Extraction-level summary statistics</h4>
                    <clr-datagrid [clrDgLoading]="qualityControlReportLoading" #qualityControlReport_EB_QC_DataGrid>

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('qualityControlReport_EB_QC')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="quality_control_report_EB_QC_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'metric'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Metric
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'value'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Value
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'count'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Count
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-row *ngFor="let item of qualityControlReportResults.extraction_quality_control"
                            [clrDgItem]="item">
                            <clr-dg-cell>{{item.metric}}</clr-dg-cell>
                            <clr-dg-cell>{{item.value}}</clr-dg-cell>
                            <clr-dg-cell>{{item.count}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{qualityControlReport_EB_QC_Pagination.firstItem + 1}} -
                            {{qualityControlReport_EB_QC_Pagination.lastItem + 1}} of
                            {{qualityControlReport_EB_QC_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #qualityControlReport_EB_QC_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                </clr-tab-content>
            </clr-tab>
            <!-- End Quality Control Report tab -->

            <!--Control Results tab -->
            <clr-tab>
                <button clrTabLink (mouseout)="resizeTable('controlsResultReport')">Controls Results Report</button>
                <clr-tab-content (mouseover)="resizeTable('controlsResultReport')">

                    <!--5 tables (DataGrids) -->
                    <h4>Extraction Negative</h4>

                    <clr-datagrid #controlsResultReport_extNeg_DataGrid [clrDgLoading]="controlsResultReportLoading">

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('controlsResultReport_extNeg')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="controls_result_report_extNeg_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column *ngFor="let target of controlsResultReportResults.targets" [clrDgField]="target">
                            {{target}}</clr-dg-column>

                        <clr-dg-row *ngFor="let control of controlsResultReportResults.ext_neg" [clrDgItem]="control">
                            <clr-dg-cell>{{control.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{control.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell class="dynamic-column"
                                *ngFor="let target of controlsResultReportResults.targets">
                                {{control[target]}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{controlsResultReport_extneg_Pagination.firstItem + 1}} -
                            {{controlsResultReport_extneg_Pagination.lastItem + 1}} of
                            {{controlsResultReport_extneg_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #controlsResultReport_extneg_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>Extraction Positive</h4>

                    <clr-datagrid #controlsResultReport_extPos_DataGrid [clrDgLoading]="controlsResultReportLoading">
                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('controlsResultReport_extPos')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="controls_result_report_extPos_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column *ngFor="let target of controlsResultReportResults.targets" [clrDgField]="target">
                            {{target}}</clr-dg-column>

                        <clr-dg-row *ngFor="let control of controlsResultReportResults.ext_pos" [clrDgItem]="control">
                            <clr-dg-cell>{{control.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{control.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell class="dynamic-column"
                                *ngFor="let target of controlsResultReportResults.targets">
                                {{control[target]}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{controlsResultReport_extpos_Pagination.firstItem + 1}} -
                            {{controlsResultReport_extpos_Pagination.lastItem + 1}} of
                            {{controlsResultReport_extpos_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #controlsResultReport_extpos_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>PCR Negative</h4>

                    <clr-datagrid #controlsResultReport_pcrNeg_DataGrid [clrDgLoading]="controlsResultReportLoading">

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('controlsResultReport_pcrNeg')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="controls_result_report_pcrNeg_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'pcrreplicatebatch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                PCR Replicate Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column *ngFor="let target of controlsResultReportResults.targets" [clrDgField]="target">
                            {{target}}</clr-dg-column>

                        <clr-dg-row *ngFor="let control of controlsResultReportResults.pcr_neg" [clrDgItem]="control">
                            <clr-dg-cell>{{control.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{control.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell class="dynamic-column"
                                *ngFor="let target of controlsResultReportResults.targets">
                                {{control[target]}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{controlsResultReport_pcrneg_Pagination.firstItem + 1}} -
                            {{controlsResultReport_pcrneg_Pagination.lastItem + 1}} of
                            {{controlsResultReport_pcrneg_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #controlsResultReport_pcrneg_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>PCR Positive</h4>

                    <clr-datagrid #controlsResultReport_pcrPos_DataGrid [clrDgLoading]="controlsResultReportLoading">

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('controlsResultReport_pcrPos')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="controls_result_report_pcrPos_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'analysis_batch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Analysis Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'extraction_number'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                Extraction Number
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'pcrreplicatebatch'">
                            <ng-container *clrDgHideableColumn="{hidden: false}">
                                PCR Replicate Batch
                            </ng-container>
                        </clr-dg-column>

                        <clr-dg-column *ngFor="let target of controlsResultReportResults.targets" [clrDgField]="target">
                            {{target}}</clr-dg-column>

                        <clr-dg-row *ngFor="let control of controlsResultReportResults.pcr_pos" [clrDgItem]="control">
                            <clr-dg-cell>{{control.analysis_batch}}</clr-dg-cell>
                            <clr-dg-cell>{{control.extraction_number}}</clr-dg-cell>
                            <clr-dg-cell class="dynamic-column"
                                *ngFor="let target of controlsResultReportResults.targets">
                                {{control[target]}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{controlsResultReport_pcrpos_Pagination.firstItem + 1}} -
                            {{controlsResultReport_pcrpos_Pagination.lastItem + 1}} of
                            {{controlsResultReport_pcrpos_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #controlsResultReport_pcrpos_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                    <h4>Pegnegs</h4>
                 
                    <clr-datagrid #controlsResultReport_pegneg_DataGrid [clrDgLoading]="controlsResultReportLoading">

                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button type="button" class="btn btn-sm btn-secondary"
                                    (click)="exportToCSV('controlsResultReport_pegneg')">
                                    <clr-icon shape="export" size="16"></clr-icon> Export to CSV
                                </button>
                            </div>
                            <div class="form-group">
                                <form [formGroup]="reportSelectForm">
                                    <label>Export File name (optional)</label>
                                    <input type="text" class="filename-input"
                                        formControlName="controls_result_report_pegneg_filename">
                                </form>
                            </div>
                        </clr-dg-action-bar>

                        <clr-dg-column [clrDgField]="'id'">
                            Sample/PegNeg ID
                            <clr-dg-filter [clrDgFilter]="rangeFilter">
                                <range-filter #rangeFilter></range-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column [clrDgField]="'collection_start_date'">
                            Collect Start Date
                            <clr-dg-filter [clrDgFilter]="CollectionStartDateFilter">
                                <collection-start-date-filter [dateField]="'collection_start_date'"
                                    #CollectionStartDateFilter>
                                </collection-start-date-filter>
                            </clr-dg-filter>
                        </clr-dg-column>

                        <clr-dg-column *ngFor="let target of controlsResultReportResults.targets" [clrDgField]="target">
                            {{target}}</clr-dg-column>

                        <clr-dg-row *ngFor="let control of controlsResultReportResults.peg_neg" [clrDgItem]="control">
                            <clr-dg-cell>{{control.id}}</clr-dg-cell>
                            <clr-dg-cell>{{control.collection_start_date | date:'shortDate'}}</clr-dg-cell>
                            <clr-dg-cell class="dynamic-column"
                                *ngFor="let target of controlsResultReportResults.targets">
                                {{control[target]}}</clr-dg-cell>
                        </clr-dg-row>

                        <clr-dg-footer>
                            {{controlsResultReport_pegneg_Pagination.firstItem + 1}} -
                            {{controlsResultReport_pegneg_Pagination.lastItem + 1}} of
                            {{controlsResultReport_pegneg_Pagination.totalItems}}
                            results
                            <clr-dg-pagination #controlsResultReport_pegneg_Pagination [clrDgPageSize]="10">
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>

                </clr-tab-content>
            </clr-tab>
            <!--End Control Results tab -->

        </clr-tabs>

    </div>
</div>